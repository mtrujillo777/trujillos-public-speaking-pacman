<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mr. Trujillo's Speech Anxiety Arcade</title>

<style>
body {
  margin: 0;
  background: black;
  color: white;
  font-family: Arial, sans-serif;
  text-align: center;
}

#gameContainer {
  display: none;
  flex-direction: column;
  align-items: center;
}

canvas {
  background: black;
  max-width: 100%;
  height: auto;
}

button {
  padding: 10px 16px;
  margin: 6px;
  font-size: 16px;
}

#controls {
  display: grid;
  grid-template-columns: 60px 60px 60px;
  gap: 6px;
  margin-top: 10px;
}

#controls button {
  font-size: 18px;
}

#overlay {
  padding: 20px;
  max-width: 800px;
  margin: auto;
}

.hidden {
  display: none;
}
</style>
</head>

<body>

<div id="overlay">
  <h2>Mr. Trujillo's Speech Anxiety Arcade</h2>
  <p>
Speech anxiety, or glossophobia, is the "fight-or-flight" response triggered by the fear of being judged.
It feels like a threat, but it‚Äôs actually just misplaced energy. Overcoming it requires preparation,
steady breathing, and reframing nervous jitters as excitement.
  </p>
  <p>
This game transforms that internal struggle into a winnable battle.
  </p>

  <h3>How to Play</h3>
  <ul style="text-align:left">
    <li><b>The Ghosts:</b> Anxious thoughts ‚Äî intimidating, but powerless if you keep moving.</li>
    <li><b>Arrow Buttons:</b> One press per move ‚Äî deliberate pacing.</li>
    <li><b>Confidence Pellets:</b> Each one represents a successful moment.</li>
    <li><b>Microphones:</b> Power-ups ‚Äî owning your voice makes fear vulnerable.</li>
  </ul>

  <p><b>The Goal:</b> Stay calm, move with purpose, and silence the ghosts of doubt.</p>

  <button onclick="startGame()">Start Game</button>
</div>

<div id="gameContainer">
  <div>
    Score: <span id="score">0</span>
    <button onclick="toggleSound()">üîä</button>
  </div>

  <canvas id="game" width="360" height="360"></canvas>

  <div id="controls">
    <div></div>
    <button onclick="move('up')">‚¨ÜÔ∏è</button>
    <div></div>
    <button onclick="move('left')">‚¨ÖÔ∏è</button>
    <button onclick="move('down')">‚¨áÔ∏è</button>
    <button onclick="move('right')">‚û°Ô∏è</button>
  </div>

  <button id="resetBtn" class="hidden" onclick="resetGame()">Reset</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const tile = 20;
let score = 0;
let soundOn = true;
let powerMode = false;
let gameOver = false;

const maze = [
"##################",
"#........##......#",
"#.####.#.##.#.####.#",
"#M....#......#....M#",
"#.####.#.##.#.####.#",
"#........##......#",
"##################"
];

let pacman = { x: 1, y: 1, dir: "right", mouth: 0 };

let ghosts = [
  { x: 8, y: 3, color: "red", vulnerable: false },
  { x: 9, y: 3, color: "pink", vulnerable: false },
  { x: 10, y: 3, color: "cyan", vulnerable: false }
];

let pellets = [];
let microphones = [];

maze.forEach((row,y)=>{
  [...row].forEach((cell,x)=>{
    if(cell === ".") pellets.push({x,y});
    if(cell === "M") microphones.push({x,y});
  });
});

function startGame(){
  document.getElementById("overlay").style.display = "none";
  document.getElementById("gameContainer").style.display = "flex";
  draw();
}

function toggleSound(){
  soundOn = !soundOn;
}

function playSound(freq){
  if(!soundOn) return;
  const audio = new AudioContext();
  const osc = audio.createOscillator();
  osc.frequency.value = freq;
  osc.connect(audio.destination);
  osc.start();
  osc.stop(audio.currentTime + 0.1);
}

function drawPacman(){
  ctx.fillStyle = "yellow";
  ctx.beginPath();
  ctx.moveTo(pacman.x*tile+10, pacman.y*tile+10);
  let angle = pacman.mouth ? 0.25 : 0.05;
  let start = 0, end = Math.PI*2;

  if(pacman.dir==="right"){ start=angle; end=2*Math.PI-angle;}
  if(pacman.dir==="left"){ start=Math.PI+angle; end=Math.PI*3-angle;}
  if(pacman.dir==="up"){ start=1.5*Math.PI+angle; end=1.5*Math.PI-angle;}
  if(pacman.dir==="down"){ start=0.5*Math.PI+angle; end=0.5*Math.PI-angle;}

  ctx.arc(pacman.x*tile+10,pacman.y*tile+10,8,start,end);
  ctx.fill();
}

function drawGhost(g){
  ctx.fillStyle = g.vulnerable ? "blue" : g.color;
  ctx.beginPath();
  ctx.arc(g.x*tile+10,g.y*tile+10,8,Math.PI,0);
  ctx.rect(g.x*tile+2,g.y*tile+10,16,10);
  ctx.fill();

  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(g.x*tile+6,g.y*tile+8,2,0,2*Math.PI);
  ctx.arc(g.x*tile+14,g.y*tile+8,2,0,2*Math.PI);
  ctx.fill();
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  maze.forEach((row,y)=>{
    [...row].forEach((cell,x)=>{
      if(cell==="#"){
        ctx.fillStyle="blue";
        ctx.fillRect(x*tile,y*tile,tile,tile);
      }
    });
  });

  pellets.forEach(p=>{
    ctx.fillStyle="white";
    ctx.beginPath();
    ctx.arc(p.x*tile+10,p.y*tile+10,2,0,2*Math.PI);
    ctx.fill();
  });

  microphones.forEach(m=>{
    ctx.fillStyle="lime";
    ctx.fillRect(m.x*tile+6,m.y*tile+6,8,8);
  });

  drawPacman();
  ghosts.forEach(drawGhost);
}

function move(dir){
  if(gameOver) return;

  let dx=0,dy=0;
  if(dir==="up")dy=-1;
  if(dir==="down")dy=1;
  if(dir==="left")dx=-1;
  if(dir==="right")dx=1;

  pacman.dir=dir;
  let nx=pacman.x+dx, ny=pacman.y+dy;

  if(maze[ny][nx]!=="#"){
    pacman.x=nx; pacman.y=ny;
    pacman.mouth=!pacman.mouth;
    playSound(600);
  }

  pellets = pellets.filter(p=>{
    if(p.x===pacman.x && p.y===pacman.y){
      score+=10;
      document.getElementById("score").textContent=score;
      return false;
    }
    return true;
  });

  microphones = microphones.filter(m=>{
    if(m.x===pacman.x && m.y===pacman.y){
      powerMode=true;
      ghosts.forEach(g=>g.vulnerable=true);
      playSound(300);
      setTimeout(()=>{
        powerMode=false;
        ghosts.forEach(g=>g.vulnerable=false);
      },5000);
      return false;
    }
    return true;
  });

  ghosts.forEach(g=>{
    if(g.x===pacman.x && g.y===pacman.y){
      gameOver=true;
      alert("üòî Anxiety got the best of you.  Practice overcomes anxiety!");
      document.getElementById("resetBtn").classList.remove("hidden");
    }
  });

  if(pellets.length===0){
    gameOver=true;
    alert("You win! üéâ");
    document.getElementById("resetBtn").classList.remove("hidden");
  }

  draw();
}

function resetGame(){
  location.reload();
}

draw();
</script>

</body>
</html>
