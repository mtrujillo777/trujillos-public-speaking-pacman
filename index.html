<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Trujillo's Public Speaking Pac-Man</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin:0;
  background:black;
  color:white;
  font-family:Arial,sans-serif;
  text-align:center;
}
h1 { margin:6px 0; font-size:22px; }

#gameContainer { display:none; max-width:420px; margin:auto; }

canvas {
  width:100%;
  height:auto;
  background:black;
  border:3px solid #1e90ff;
}

#topBar {
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:14px;
  margin:6px;
}

#message {
  color:gold;
  min-height:20px;
}

button {
  border:none;
  border-radius:8px;
  padding:6px 12px;
  cursor:pointer;
}

#startBtn {
  padding:14px 28px;
  font-size:18px;
  background:gold;
}

#controls {
  margin-top:8px;
}

.ctrlRow { display:flex; justify-content:center; }

.ctrlBtn {
  width:60px;
  height:60px;
  margin:4px;
  font-size:22px;
  background:#333;
  color:white;
}
</style>
</head>

<body>

<h1>ğŸ¤ Trujillo's Public Speaking</h1>

<button id="startBtn">Start Game</button>

<div id="gameContainer">
  <div id="topBar">
    <div id="score">Score: 0</div>
    <button id="soundBtn">ğŸ”Š</button>
  </div>

  <div id="message"></div>

  <canvas id="game"></canvas>

  <button id="resetBtn" style="display:none;margin-top:8px;background:#ff5555;">
    Reset Game
  </button>

  <div id="controls">
    <div class="ctrlRow">
      <button class="ctrlBtn" onclick="movePacman(0,-1)">â¬†ï¸</button>
    </div>
    <div class="ctrlRow">
      <button class="ctrlBtn" onclick="movePacman(-1,0)">â¬…ï¸</button>
      <button class="ctrlBtn" onclick="movePacman(1,0)">â¡ï¸</button>
    </div>
    <div class="ctrlRow">
      <button class="ctrlBtn" onclick="movePacman(0,1)">â¬‡ï¸</button>
    </div>
  </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const TILE=20, ROWS=21, COLS=21;
canvas.width=COLS*TILE;
canvas.height=ROWS*TILE;

let soundOn=true;
let score=0;
let power=false;
let gameOver=false;

const baseMaze=[
[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
[1,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1],
[1,2,1,1,1,2,1,1,2,1,2,1,1,2,1,1,2,1,1,2,1],
[1,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,1],
[1,2,1,1,2,1,1,2,1,1,1,1,1,2,1,1,2,1,1,2,1],
[1,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1],
[1,1,1,1,1,2,1,1,2,1,2,1,1,2,1,1,2,1,1,1,1],
[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
[1,2,1,1,2,1,1,2,1,1,1,1,1,2,1,1,2,1,1,2,1],
[1,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1],
[1,1,1,1,1,1,1,1,2,1,2,1,1,2,1,1,1,1,1,1,1],
[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
[1,2,1,1,2,1,1,2,1,1,1,1,1,2,1,1,2,1,1,2,1],
[1,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1],
[1,1,1,1,1,2,1,1,2,1,2,1,1,2,1,1,2,1,1,1,1],
[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
[1,2,1,1,2,1,1,2,1,1,1,1,1,2,1,1,2,1,1,2,1],
[1,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1],
[1,2,1,1,1,1,1,1,2,1,2,1,1,2,1,1,1,1,1,2,1],
[1,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,1],
[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
];

let maze, pacman, ghosts;

function play(freq){
  if(!soundOn) return;
  const a=new AudioContext(), o=a.createOscillator();
  o.frequency.value=freq; o.connect(a.destination);
  o.start(); setTimeout(()=>o.stop(),90);
}

function resetGame(){
  maze=JSON.parse(JSON.stringify(baseMaze));
  pacman={x:1,y:1,dir:"right"};
  ghosts=[
    {x:10,y:9,color:"red"},
    {x:9,y:9,color:"pink"},
    {x:11,y:9,color:"cyan"},
    {x:10,y:10,color:"orange"}
  ];
  score=0; power=false; gameOver=false;
  document.getElementById("score").innerText="Score: 0";
  document.getElementById("message").innerText="";
  document.getElementById("resetBtn").style.display="none";
  draw();
}

function movePacman(dx,dy){
  if(gameOver) return;
  const nx=pacman.x+dx, ny=pacman.y+dy;
  if(maze[ny][nx]!==1){
    pacman.x=nx; pacman.y=ny;
    pacman.dir=dx?dx>0?"right":"left":dy>0?"down":"up";
    if(maze[ny][nx]===2){ score+=10; play(600); }
    if(maze[ny][nx]===3){
      power=true; play(300);
      setTimeout(()=>power=false,6000);
    }
    maze[ny][nx]=0;
    moveGhosts();
    checkCollision();
    draw();
    checkWin();
  }
}

function moveGhosts(){
  ghosts.forEach(g=>{
    const dirs=[[1,0],[-1,0],[0,1],[0,-1]];
    const d=dirs[Math.floor(Math.random()*4)];
    if(maze[g.y+d[1]][g.x+d[0]]!==1){
      g.x+=d[0]; g.y+=d[1];
    }
  });
}

function checkCollision(){
  ghosts.forEach((g,i)=>{
    if(g.x===pacman.x&&g.y===pacman.y){
      if(power){
        ghosts[i]={x:10,y:9,color:g.color};
        score+=50; play(800);
      } else {
        gameOver=true;
        play(120);
        document.getElementById("message").innerText="ğŸ’€ Speech anxiety wins!";
        document.getElementById("resetBtn").style.display="block";
      }
    }
  });
}

function checkWin(){
  if(maze.flat().every(c=>c!==2&&c!==3)){
    gameOver=true;
    play(900);
    document.getElementById("message").innerText="ğŸ† Public Speaking Mastery!";
    document.getElementById("resetBtn").style.display="block";
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  maze.forEach((r,y)=>r.forEach((c,x)=>{
    if(c===1){ctx.fillStyle="blue";ctx.fillRect(x*TILE,y*TILE,TILE,TILE);}
    if(c===2){ctx.fillStyle="white";ctx.beginPath();ctx.arc(x*TILE+10,y*TILE+10,3,0,7);ctx.fill();}
    if(c===3){ctx.fillStyle="gold";ctx.font="14px Arial";ctx.fillText("ğŸ¤",x*TILE+2,y*TILE+15);}
  }));
  ghosts.forEach(g=>{
    ctx.fillStyle=power?"#555":g.color;
    ctx.beginPath();ctx.arc(g.x*TILE+10,g.y*TILE+10,10,0,7);ctx.fill();
  });
  ctx.fillStyle="yellow";
  ctx.beginPath();
  ctx.arc(pacman.x*TILE+10,pacman.y*TILE+10,10,0.25*Math.PI,1.75*Math.PI);
  ctx.lineTo(pacman.x*TILE+10,pacman.y*TILE+10);
  ctx.fill();
}

document.getElementById("startBtn").onclick=()=>{
  document.getElementById("startBtn").style.display="none";
  document.getElementById("gameContainer").style.display="block";
  resetGame();
};

document.getElementById("resetBtn").onclick=resetGame;
document.getElementById("soundBtn").onclick=()=>{
  soundOn=!soundOn;
  document.getElementById("soundBtn").innerText=soundOn?"ğŸ”Š":"ğŸ”‡";
};
</script>
</body>
</html>
